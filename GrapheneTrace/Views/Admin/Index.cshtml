@model GrapheneTrace.ViewModels.AdminDashboardViewModel

@{
    ViewData["Title"] = "Admin Dashboard";
}

<h2 class="mb-4 fw-bold">Admin Dashboard</h2>

<!-- ===================== SUMMARY CARDS ===================== -->
<div class="row mb-4">
    <div class="col-md-2">
        <div class="card text-center shadow-sm">
            <div class="card-body">
                <h5 class="text-muted">Users</h5>
                <p class="display-6 fw-bold">@Model.TotalUsers</p>
            </div>
        </div>
    </div>

    <div class="col-md-2">
        <div class="card text-center shadow-sm">
            <div class="card-body">
                <h5 class="text-muted">Patients</h5>
                <p class="display-6 fw-bold">@Model.TotalPatients</p>
            </div>
        </div>
    </div>

    <div class="col-md-2">
        <div class="card text-center shadow-sm">
            <div class="card-body">
                <h5 class="text-muted">Clinicians</h5>
                <p class="display-6 fw-bold">@Model.TotalClinicians</p>
            </div>
        </div>
    </div>

    <div class="col-md-2">
        <div class="card text-center shadow-sm">
            <div class="card-body">
                <h5 class="text-muted">Alerts</h5>
                <p class="display-6 fw-bold">@Model.TotalAlerts</p>
            </div>
        </div>
    </div>

    <div class="col-md-2">
        <div class="card text-center shadow-sm">
            <div class="card-body">
                <h5 class="text-muted">Appts</h5>
                <p class="display-6 fw-bold">@Model.TotalAppointments</p>
            </div>
        </div>
    </div>

    <div class="col-md-2">
        <div class="card text-center shadow-sm">
            <div class="card-body">
                <h5 class="text-muted">Feedback</h5>
                <p class="display-6 fw-bold">@Model.TotalFeedback</p>
            </div>
        </div>
    </div>
</div>

<!-- ===================== ACTION BUTTONS ===================== -->
<div class="mb-4">
    <a class="btn btn-primary me-2" href="/Admin/CreateUser">➕ Create New User</a>
    <a class="btn btn-outline-primary me-2" href="/Appointment/Index">📅 Manage Appointments</a>
    <a class="btn btn-outline-primary me-2" href="/Admin/Patients">👤 Patient List</a>
    <a class="btn btn-outline-primary me-2" href="/Admin/Clinicians">🩺 Clinician List</a>
    <a class="btn btn-outline-primary me-2" href="/Admin/Alerts">🚨 View All Alerts</a>
    <a class="btn btn-outline-primary" href="/Admin/Feedback">💬 View Feedback</a>
</div>


<!-- ===================== RECENT ACTIVITY ===================== -->
<div class="row">

    <!-- ========== Recent Alerts ========== -->
    <div class="col-md-4">
        <div class="card shadow-sm mb-4">
            <div class="card-header fw-bold">Recent Alerts</div>
            <div class="card-body" style="max-height:350px; overflow-y:auto;">
                @if (Model.RecentAlerts.Any())
                {
                    <ul class="list-group">
                        @foreach (var a in Model.RecentAlerts)
                        {
                            <li class="list-group-item">
                                <strong>@a.Patient.UserAccount.Email</strong><br />
                                <span class="text-muted">@a.AlertType - @a.Severity</span><br />
                                <small>@a.TriggeredAt.ToLocalTime()</small>
                            </li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-muted">No alerts found.</p>
                }
            </div>
        </div>
    </div>

    <!-- ========== Recent Appointments ========== -->
    <div class="col-md-4">
        <div class="card shadow-sm mb-4">
            <div class="card-header fw-bold">Recent Appointments</div>
            <div class="card-body" style="max-height:350px; overflow-y:auto;">
                @if (Model.RecentAppointments.Any())
                {
                    <ul class="list-group">
                        @foreach (var a in Model.RecentAppointments)
                        {
                            <li class="list-group-item">
                                <strong>@a.Patient.UserAccount.Email</strong><br />
                                Clinician: @a.Clinician.UserAccount.Email<br />
                                <small>@a.StartTime.ToLocalTime()</small>
                            </li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-muted">No appointments available.</p>
                }
            </div>
        </div>
    </div>

    <!-- ========== Recent Feedback ========== -->
    <div class="col-md-4">
        <div class="card shadow-sm mb-4">
            <div class="card-header fw-bold">Recent Feedback</div>
            <div class="card-body" style="max-height:350px; overflow-y:auto;">
                @if (Model.RecentFeedback.Any())
                {
                    <ul class="list-group">
                        @foreach (var f in Model.RecentFeedback)
                        {
                            <li class="list-group-item">
                                <strong>@f.Patient.UserAccount.Email</strong><br />
                                @f.Comment<br />
                                <small>@f.CreatedAt.ToLocalTime()</small>
                            </li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-muted">No feedback yet.</p>
                }
            </div>
        </div>
    </div>

</div>
